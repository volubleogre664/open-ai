import{d as I,r as o,o as r,c,a as n,b as i,F as g,e as H,f,_,g as x,h as w}from"./_plugin-vue_export-helper.34eb5909.js";import{w as k}from"./index.832b91df.js";import{d as l}from"./index.bfe2db98.js";import{d}from"./index.fb71bee9.js";import{S}from"./SidebarHistory.3ecd085c.js";import{C as A}from"./ChatItem.05a5acdf.js";import"./HistoryItem.18a3e533.js";const a="/ChatWebAPI/",B="/HistoryWebAPI/",N=d.exports.createStore({key:"message",loadUrl:a+"Get/",insertUrl:a+"Post/",insertMethod:"POST",loadMethod:"GET",onBeforeSend:function(e,t){t.xhrFields={withCredentials:!0}}}),b=d.exports.createStore({key:"HistoryId",loadUrl:B+"Get/",loadMethod:"GET",loadParams:{page:"chat"},onBeforeSend:function(e,t){t.xhrFields={withCredentials:!0}}}),D=I({name:"chat-page",props:{},components:{SidebarHistory:S,ChatItem:A,DxButton:l.DxButton,DxTextArea:l.DxTextArea},data(){return{message:"",textAreaMaxHeight:"100%",chatItems:[],isNewChat:!0,history:[],currentChat:{HistoryId:0,Content:"",Click:()=>{}}}},mounted(){this.getHistory()},methods:{sendMessage(){let e=document.querySelector(".dx-texteditor-input");this.message=e.value,console.log("History Items: ",this.history),console.log("Current Chat: ",this.currentChat),N.insert({historyId:this.currentChat.HistoryId,message:this.message,isNewChat:this.isNewChat}).then(t=>{this.chatItems.push(...t);let s=document.querySelector(".chat-bodyMain");s.scrollTop=s.scrollHeight,this.isNewChat&&t.length>0&&(this.isNewChat=!1,this.currentChat={HistoryId:t[0].HistoryId,Content:t[0].Content,Click:()=>{this.isNewChat=!1,this.getChatsForHistory(t[0].HistoryId),this.currentChat={HistoryId:t[0].HistoryId,Content:t[0].Content,Click:()=>{}}}},this.history.push(this.currentChat))}),e.value="",this.message=""},newChatClicked(){this.isNewChat=!0,this.currentChat={HistoryId:0,Content:"",Click:()=>{}},this.chatItems=[]},getHistory(){b.load().then(e=>{console.log("History: ",e);let t=e.map(s=>({HistoryId:s.HistoryId,Content:s.Content,Click:()=>{this.getChatsForHistory(s.HistoryId),this.isNewChat=!1,this.currentChat={HistoryId:s.HistoryId,Content:s.Content,Click:()=>{}}}}));this.history=t})},getChatsForHistory(e){let t=`${a}Get?historyId=${e}&isNewChat=false`;fetch(t).then(s=>s.json()).then(({data:s})=>{this.chatItems=s})}}}),v={class:"chat"},T={class:"chat-body"},F={class:"chat-bodyMain"},M={class:"chat-bodyFooter"};function P(e,t,s,C,$,G){const m=o("SidebarHistory"),u=o("ChatItem"),y=o("DxTextArea"),p=o("DxButton");return r(),c("div",v,[n(m,{newChatClick:e.newChatClicked,historyItems:e.history},null,8,["newChatClick","historyItems"]),i("main",T,[i("div",F,[(r(!0),c(g,null,H(e.chatItems,h=>(r(),f(u,{message:h.Content,isBot:h.IsBot},null,8,["message","isBot"]))),256))]),i("footer",M,[n(y,{"max-hight":300,"auto-resize-enabled":!0,width:"100%",placeholder:"Type a message..."}),n(p,{text:"Send","styling-mode":"contained",type:"default",onClick:e.sendMessage},null,8,["onClick"])])])])}const U=_(D,[["render",P],["__file","C:/Users/nduduzos/source/repos/OpenAIAssessment/OpenAIAssessment/Client/src/pages/chat-page.vue"]]);window.customElements.define("chat-page",k(U,x,w));
